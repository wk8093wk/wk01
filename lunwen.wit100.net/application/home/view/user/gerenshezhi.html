<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>个人设置</title>
        <meta name="keywords" content="{$config.seo_keyword}" />
		<meta name="description" content="{$config.seo_dec}" />
		<link rel="stylesheet" type="text/css" href="__HOMECSS__/list.css"/>
		<link rel="stylesheet" type="text/css" href="__HOMECSS__/common.css"/>
        <link rel="stylesheet" href="__STATIC__/layuiadmin/layui/css/layui.css" media="all">
        <style>
        	.layui-btn-primary {
				border: 1px solid #fff;
				background-color: #fff;
				color: rgba(74,144,226,1);
				font-size: 12px;
			}
			.layui-btn-primary:hover {
				border-color: #fff;
				color: rgba(74,144,226,1);
			}
			.security label{line-height: 32px;}
        </style>
		<script>
        	var GetUploadify_url = "{:url('/admin/Uploadify/upload')}";
		</script>
	</head>
	<body style="background:rgba(241,239,242,1);">
    
		{include file="public/header" /}
		
		<div class="security">
			<h3>个人设置</h3>
			<div class="coner on">
				<div class="name">
					<span>*</span>头像设置
				</div>
				<div class="forbox">
					<div class="header_pic">
                   		{if $raw.head==''}<img style="width: 100%;height: 100%;" src="__HOMEIMG__/da.png" id="look1"/>
                    	{else}<img style="width: 100%;height: 100%;" src="{$raw.head}" id="look1"/>{/if}
						
					</div>
                    <div style="float:right; height:40px;">
                    <form class="layui-form" wid100 lay-filter="">
                    	<div class="layui-form-item" style="margin-bottom:0;">
                            <input type="hidden" name="head"  id="head" placeholder="图片地址" value="{$raw.head}" class="layui-input">
                            <div class="layui-input-inline layui-btn-container" style="width: auto;">
                              <button type="button" class="layui-btn layui-btn-primary" id="headUpload">
                                更换图像
                              </button>
                            </div>
                        </div>
                    </form>
                    </div>
					
				</div>
				<div class="clear"></div>
			</div>
			<div class="coner">
				<div class="name">
					<span>*</span>单位
				</div>
				<div class="forbox">
					<input type="text" id="company" name="company" value="{$raw.company}" class="text1">
				</div>
				<div class="clear"></div>
			</div>
			
			<div class="coner">
				<div class="name">
					<span>*</span>姓名
				</div>
				<div class="forbox">
					<input type="text" id="name" name="name" value="{$raw.name}" class="text1">
				</div>
				<div class="clear"></div>
			</div>
			<div class="coner">
				<div class="name">
					<span>*</span>性别
				</div>
				<div class="forbox">
					<label class="fl" for="radio1">
						<input class="radios" type="radio" id="radio1" name="sex" value="2" {if $raw.sex==2}checked{/if}>
						女
					</label>
					<label class="fl" for="radio2">
						<input class="radios" type="radio" id="radio2" name="sex" value="1" {if $raw.sex==1}checked{/if}>
						男
					</label>
				</div>
				<div class="clear"></div>
			</div>
			<div class="coner">
				<div class="name">
					<span>*</span>职称
				</div>
				<div class="forbox">
					<input type="text" id="title" name="title" value="{$raw.title}" class="text1">
				</div>
				<div class="clear"></div>
			</div>
			<div class="coner">
				<div class="name">
					<span>*</span>部门职务
				</div>
				<div class="forbox">
					<input type="text" id="department" name="department" value="{$raw.department}" class="text1">
				</div>
				<div class="clear"></div>
			</div>
            <input type="hidden" name="user_id" id="user_id" value="{$user_id}">
			<input type="submit" id="" name="" value="提交" class="tj_btn" onClick="geren()"/>
            
		</div>

			{include file="public/footer" /}

		<script type="text/javascript" src="__HOMEJS__/jquery-1.9.1.min.js" ></script>
		<script type="text/javascript" src="__HOMEJS__/rili.js" ></script>
       <!-- <script src="__STATIC__/layuiadmin/layer/layer.js"></script>-->
        <script type="text/javascript" src="__HOMEJS__/laydate/laydate.js" ></script>
        <script src="__STATIC__/layuiadmin/layui/layui.js"></script>
        
        
        <script>
			var url= "/admin/product/assistance_json/catid/{$id}.html";
			var editUrl = "/admin/product/assistance_edit.html";
			var addUrl = "/admin/product/assistance_add/catid/{$id}.html";
			var delUrl = "/admin/product/assistance_del.html";
			var delAllUrl="/admin/product/assistance_dels.html";
			var sortUrl= "/admin/product/listorder.html";
			layui.config({
				base: '__STATIC__/layuiadmin/',version: true    }).extend({
				index: 'lib/index' //主入口模块
			}).use(['index','head']);
		</script>
    	<script>
			/*$('#headUpload1').change(function() {
				//获取到file的文件
				var docObj = document.getElementById("headUpload1");
				//获取到预览框的文件
				var imgObjPreview = document.getElementById("look1");
				//获取到文件名和类型
				if(docObj.files && docObj.files[0]) {
					console.log(docObj.files)
					//火狐7以上版本不能用上面的getAsDataURL()方式获取，需要一下方式
					imgObjPreview.src = window.URL.createObjectURL(docObj.files[0]);
				} else {
					//IE下，使用滤镜
					docObj.select();
					var imgSrc = document.selection.createRange().text;
					var localImagId = document.getElementById("localImag");
					//图片异常的捕捉，防止用户修改后缀来伪造图片
					try {
						localImagId.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale)";
						localImagId.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src = imgSrc;
					} catch(e) {
						alert("您上传的图片格式不正确，请重新选择!");
						return false;
					}
					document.selection.empty();
				}
				return true;
			});*/
		</script>

        
                        
        <script>
        	function geren(){
				var user_id=$('#user_id').val();
				var head=$('#head').val();
				var company=$('#company').val();
				var name=$('#name').val();
				var sex=$("input[name='sex']:checked").val();
				var title=$('#title').val();
				var department=$('#department').val();
				
				console.log(head);
				
				if(company == ''){
					layer.msg('请输入单位！', {time: 1500});
					return false;
				}
				if(name == ''){
					layer.msg('请输入姓名！', {time: 1500});
					return false;
				}
				
				if(sex != 1&&sex != 2){
					layer.msg('请选择性别！', {time: 1500});
					return false;
				}
				
				
				if(title == ''){
					layer.msg('请输入职称！', {time: 1500});
					return false;
				}
				if(department == ''){
					layer.msg('请输入部门及职务！', {time: 1500});
					return false;
				}
			
				
				$.ajax({
						url: "{:url('user/geren')}",
						type:"POST",
						data:{user_id:user_id,company:company,name:name,sex:sex,title:title,department:department,head:head},
						//catid:catid,
						dataType:"json",
						success: function(data){
							console.log(data);
							if(data.code==0){
								layer.msg('修改成功！', {time: 1500},function(){
									window.location.href="/home/user/gerenshezhi.html?id={$user_id}";
								});
								
							}else{
								layer.msg('修改失败！', {time: 1500});
							}
					   }
			 });
				
			}
        
        </script>
		
	</body>
</html>
